{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nconst URL = \"https://pixabay.com/api/\";\nconst API_KEY = \"45133335-13ec6f60d2d4b23fe19aa58e6\";\n\nexport default async function searchImagesByQuery(query,  page = 1, perPage  = 15) {\n    try { \n        const response = await axios.get(URL, {\n            params: {\n                key: API_KEY,\n                q: query,\n                image_type: \"photo\",\n                orientation: \"horizontal\",\n                safesearch: true,\n                page: page,\n                per_page: perPage \n            }\n        })\n        return response.data\n    }\n    catch (error) {\n        throw new Error(error.response ? error.response.data : error.message);\n    }\n    // return fetch(`${URL}?key=${API_KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true`)\n    //     .then((response) => {\n    //         if (!response.ok) {\n    //             throw new Error(response.status);\n    //         }\n    //         return response.json();\n    //     })\n}\n","// Описаний у документації\nimport iziToast from \"izitoast\";\n// Додатковий імпорт стилів\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n// Описаний у документації\nimport SimpleLightbox from \"simplelightbox\";\n// Додатковий імпорт стилів\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nexport function showError(error) {\n    iziToast.error({\n        position: \"topRight\",\n        message: `${error}`,\n    });\n}\n\nexport function createGallary(data) {\n    const galleryList = document.querySelector('.gallery-list');\n    const lightbox = new SimpleLightbox('.gallery-item a', {\n    captions: true,\n    captionSelector: 'img',\n    captionType: 'attr',\n    captionsData: 'alt',\n    captionPosition: 'bottom',\n    captionDelay:  250,\n});\n    const images = data.hits.map((hit) =>`\n    <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${hit.largeImageURL}\">\n            <img class=\"gallery-image\"\n                src=\"${hit.webformatURL}\"\n                alt=\"${hit.tags}\" \n            />\n        </a>\n        <div class=\"gallery-content\">\n            <h5 class=\"text-content\">Likes<p class=\"text\">${hit.likes}</p></h5>\n            <h5 class=\"text-content\">Views<p class=\"text\">${hit.views}</p></h5>\n            <h5 class=\"text-content\">Comments<p class=\"text\">${hit.comments}</p></h5>\n            <h5 class=\"text-content\">Downloads<p class=\"text\">${hit.downloads}</p></h5>\n        </div>\n    </li>`).join('');\n\n    galleryList.insertAdjacentHTML(\"beforeend\", images);\n    lightbox.refresh();\n}\n\nexport function cleanGallery() {\n    const list = document.querySelector(\".gallery-list\");\n    list.innerHTML = \"\";\n}","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n// import SimpleLightbox from \"simplelightbox\";\n// import \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport searchImagesByQuery from './js/pixabay-api.js';\nimport { showError, createGallary, cleanGallery } from './js/render-functions.js';\n\nconst form = document.querySelector('.gallery-form');\nconst input = document.querySelector('.input-gallery');\nconst loader = document.querySelector('.loading');\nconst loadMoreBtn = document.querySelector('.load-btn');\n// const card = document.querySelector('.gallery-item');\nlet currentPage = 1;\nconst resultsPerPage = 15;\nlet currentQuery = '';\n\n\n\nform.addEventListener('submit', async (event) => {\n    event.preventDefault();\n    currentPage = 1;\n    currentQuery = input.value.trim();\n\n    cleanGallery(); //  очищуєм галерею\n    loadMoreBtn.classList.add('hidden');\n    await performSearch()\n});\n\n\nloadMoreBtn.addEventListener('click', () => {\n    currentPage++;\n    performSearch();\n    });\n\n\nasync function performSearch() {\n  loader.classList.remove('hidden'); // показуємо індикатор завантаження\n\n    if (currentQuery === '') {\n    showError('Please enter a search query.');\n    loader.classList.add(\"hidden\");\n    return;\n    }\n\n    try {\n    const data = await searchImagesByQuery(currentQuery, currentPage, resultsPerPage);\n    if (data.total === 0) {\n        showError('Sorry, there are no images matching your search query. Please try again!');\n    } else {\n        // console.log(data);\n        if (currentPage > 1) {\n        const galleryHeightB = document.querySelector('.gallery-list').getBoundingClientRect().height;\n        createGallary(data);\n        const galleryHeightA = document.querySelector('.gallery-list').getBoundingClientRect().height;\n        console.log(document.querySelector('.gallery-list').getBoundingClientRect())\n        window.scrollBy({\n            top: (galleryHeightA - galleryHeightB)*0.6,\n            behavior: 'smooth'\n        });\n        } else {\n            createGallary(data);\n        }\n        if (data.hits.length < resultsPerPage) { //const images = data.hits дожина галереї\n            loadMoreBtn.classList.add('hidden'); // якщо менше результатів, ховаємо кнопку\n            return iziToast.info({\n                    position: \"topRight\",\n                    message: \"We're sorry, but you've reached the end of search results.\"\n                });\n        } else {\n            if (data.totalHits > ( currentPage * resultsPerPage)) {\n                loadMoreBtn.classList.remove('hidden'); // показуємо кнопку \"Load more\"\n                // console.log(currentPage)\n            } else {\n                // console.log(1)\n                    loadMoreBtn.classList.add('hidden'); // показуємо кнопку \"Load more\"\n                    return iziToast.info({\n                    position: \"topRight\",\n                    message: \"We're sorry, but you've reached the end of search results.\"\n                });\n            }\n        }\n    }\n    } catch (error) {\n    showError(error.message);\n    } finally {\n    loader.classList.add(\"hidden\"); // ховаємо індикатор завантаження\n        input.value = '';\n    }\n}\n\n// ---- другий варіант ---\n// try {\n//         const data = await searchImagesByQuery(currentQuery, currentPage, resultsPerPage);\n//         if (data.total === 0) {\n//             showError('Sorry, there are no images matching your search query. Please try again!');\n//         } else {\n//             console.log(data);\n//             const { height: cardHeight } = document.querySelector('.gallery-item').getBoundingClientRect();\n//             createGallary(data);\n//             if (currentPage > 1) {\n//                 window.scrollBy({\n//                     top: cardHeight * 2, // Прокручуємо на дві висоти картки\n//                     behavior: 'smooth'\n//                 });\n//             }\n//             if (data.hits.length < resultsPerPage) { // Якщо менше результатів, ховаємо кнопку\n//                 loadMoreBtn.classList.add('hidden');\n//             } else {\n//                 if (data.totalHits > (currentPage * resultsPerPage)) {\n//                     loadMoreBtn.classList.remove('hidden'); // Показуємо кнопку \"Load more\"\n//                 } else {\n//                     loadMoreBtn.classList.add('hidden');\n//                     iziToast.warning({\n//                         position: 'topRight',\n//                         message: \"We're sorry, but you've reached the end of search results.\"\n//                     });\n//                 }\n//             }\n//         }\n//     } catch (error) {\n//         showError(error.message);\n//     } finally {\n//         loader.classList.add('hidden'); // Ховаємо індикатор завантаження\n//         input.value = ''; // Скидаємо значення інпуту\n//     }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    // if (query === '') {\n    //     showError('Please enter a search query.');\n    //     loader.classList.add(\"hidden\")\n    //     return;\n    // }\n    // try {\n    //     const data = await searchImagesByQuery(query);\n    //     if (data.total === 0) {\n    //         showError('Sorry, there are no images matching your search query. Please try again!')\n    //     } else {\n    //         console.log(data);\n    //         createGallary(data);\n    //     }\n    // } catch (error) {\n    //     showError(error);\n    // } finally {\n    //     loader.classList.add(\"hidden\")\n    //     input.value = '';\n    // }\n\n\n    // searchImagesByQuery(query)\n    //     .then((data) => {\n    //         if (data.total === 0) {\n    //             showError('Sorry, there are no images matching your search query. Please try again!')\n    //             loader.classList.add(\"hidden\")\n    //             input.value = '';\n    //             return;\n    //         }\n    //         // else {\n    //         //     createGallary(data)\n    //         // }\n    //         loader.classList.add(\"hidden\")\n    //         console.log(data);\n    //         createGallary(data);\n    //         input.value = '';\n    //     })\n    //     .catch((error) => {\n    //         showError(error);\n    //         input.value = '';\n    //     });\n    \n"],"names":["URL","API_KEY","searchImagesByQuery","query","page","perPage","axios","error","showError","iziToast","createGallary","data","galleryList","lightbox","SimpleLightbox","images","hit","cleanGallery","list","form","input","loader","loadMoreBtn","currentPage","resultsPerPage","currentQuery","event","performSearch","galleryHeightB","galleryHeightA"],"mappings":"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"}